<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador de Enlaces Le Bardol</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Estilos generales y reseteo */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f9f0ff 0%, #fff0f5 100%); /* Fondo degradado suave */
            color: #4a2c5e; /* Color de texto principal */
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        /* Contenedor principal del generador */
        .container {
            max-width: 600px;
            width: 100%;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(138, 43, 226, 0.15);
            overflow: hidden;
            margin: 20px 0;
            padding: 30px;
        }
        
        h1 {
            text-align: center;
            color: #8a2be2;
            margin-bottom: 25px;
            font-size: 28px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #4a2c5e;
        }
        
        input[type="text"],
        input[type="datetime-local"],
        input[type="number"],
        textarea, 
        select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0c8f0;
            border-radius: 10px;
            font-size: 16px;
            background: #f9f0ff;
            transition: all 0.3s;
        }
        
        input[type="text"]:focus,
        input[type="datetime-local"]:focus,
        input[type="number"]:focus,
        textarea:focus, 
        select:focus {
            outline: none;
            border-color: #8a2be2;
            box-shadow: 0 0 0 3px rgba(138, 43, 226, 0.2);
        }

        .radio-group {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .radio-group label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-weight: normal;
        }

        .radio-group input[type="radio"] {
            margin-right: 8px;
            transform: scale(1.2);
            cursor: pointer;
        }

        .btn {
            display: block;
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 10px;
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        
        .btn-generate {
            background: linear-gradient(135deg, #a855f7 0%, #8a2be2 100%);
            color: white;
            margin-top: 20px;
        }
        
        .btn-copy {
            background: linear-gradient(135deg, #28a745 0%, #218838 100%);
            color: white;
            margin-top: 15px;
            display: none; /* Oculto por defecto */
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
        }
        
        .btn:active {
            transform: translateY(1px);
        }
        
        .generated-link-container {
            margin-top: 25px;
            padding: 15px;
            background: #e0f0ff;
            border: 1px dashed #a7d9f7;
            border-radius: 10px;
            word-break: break-all; /* Para asegurar que el enlace largo se ajuste */
            text-align: center;
            font-size: 15px;
            color: #007bb6;
            font-weight: 500;
        }
        /* Estilo para el enlace generado dentro del contenedor */
        .generated-link-container a {
            color: #007bb6; /* Mismo color que el texto del contenedor */
            text-decoration: underline; /* Subrayado para indicar que es un enlace */
        }


        /* Notificación de copia */
        .copy-notification {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(110%);
            background: #333;
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            opacity: 0;
            transition: all 0.3s ease-in-out;
            z-index: 1000;
        }

        .copy-notification.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

    </style>
  </head>
  <body>
    <div class="container">
      <h1>Generador de Enlaces Le Bardol</h1>

      <div class="form-group radio-group">
        <label>
          <input type="radio" name="linkType" value="reminder" checked>
          Recordatorio de Turno
        </label>
        <label>
          <input type="radio" name="linkType" value="promotion">
          Difusión / Promoción
        </label>
      </div>

      <div id="reminderFields">
        <div class="form-group">
          <label for="clientName">Nombre del Cliente (opcional)</label>
          <input type="text" id="clientName" placeholder="Ej: Juan Pérez">
        </div>
        <div class="form-group">
          <label for="appointmentDate">Fecha y Hora del Turno</label>
          <input type="datetime-local" id="appointmentDate">
        </div>
        <div class="form-group">
          <label for="referrerDiscount">Descuento para el Referente (%) (opcional)</label>
          <input type="number" id="referrerDiscount" placeholder="Ej: 10" min="0" max="100">
        </div>
        <div class="form-group">
          <label for="newClientDiscount">Descuento para el Nuevo Cliente (%) (opcional)</label>
          <input type="number" id="newClientDiscount" placeholder="Ej: 50" min="0" max="100">
        </div>
      </div>

      <div id="promotionFields" style="display: none;">
        <div class="form-group">
          <label for="promoClientName">Nombre para la Promo (opcional)</label>
          <input type="text" id="promoClientName" placeholder="Ej: María">
        </div>
        <div class="form-group">
          <label for="diffusionReferrerDiscount">Descuento para el Referente (Difusión) (%) (opcional)</label>
          <input type="number" id="diffusionReferrerDiscount" placeholder="Ej: 5" min="0" max="100">
        </div>
        <div class="form-group">
          <label for="diffusionNewClientDiscount">Descuento para el Nuevo Cliente (Difusión) (%) (opcional)</label>
          <input type="number" id="diffusionNewClientDiscount" placeholder="Ej: 5" min="0" max="100">
        </div>
        <div class="form-group">
          <label for="treatmentType">Tipo de Tratamiento (opcional)</label>
          <input type="text" id="treatmentType" placeholder="Ej: Limpieza Facial">
        </div>
      </div>
      
      <button class="btn btn-generate" id="generateLinkBtn">Generar Enlace</button>
      
      <div class="generated-link-container" id="generatedLink">
        Aquí aparecerá el enlace generado
      </div>
      
      <button class="btn btn-copy" id="copyLinkBtn">Copiar Enlace</button>
    </div>

    <div class="copy-notification" id="copyNotification">
      <i class="fas fa-check-circle"></i> Enlace copiado
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const linkTypeRadios = document.querySelectorAll('input[name="linkType"]');
            const reminderFields = document.getElementById('reminderFields');
            const promotionFields = document.getElementById('promotionFields');

            const clientNameInput = document.getElementById('clientName');
            const appointmentDateInput = document.getElementById('appointmentDate');
            const referrerDiscountInput = document.getElementById('referrerDiscount'); 
            const newClientDiscountInput = document.getElementById('newClientDiscount'); 

            const promoClientNameInput = document.getElementById('promoClientName');
            const diffusionReferrerDiscountInput = document.getElementById('diffusionReferrerDiscount'); 
            const diffusionNewClientDiscountInput = document.getElementById('diffusionNewClientDiscount'); 
            // El campo discountPercentageInput ya no existe en el HTML para la sección de promoción
            // const discountPercentageInput = document.getElementById('discountPercentage'); 
            const treatmentTypeInput = document.getElementById('treatmentType');

            const generateLinkBtn = document.getElementById('generateLinkBtn');
            const generatedLinkDiv = document.getElementById('generatedLink');
            const copyLinkBtn = document.getElementById('copyLinkBtn');
            const copyNotification = document.getElementById('copyNotification');

            // URL base de tu aplicación principal desplegada en Netlify
            const baseUrl = 'https://lebardol-app.netlify.app/index.html'; 

            function toggleLinkType(type) {
                if (type === 'reminder') {
                    reminderFields.style.display = 'block';
                    promotionFields.style.display = 'none';
                    // Limpiar campos de promo al cambiar
                    promoClientNameInput.value = '';
                    // Asegurarse de que estos elementos existan antes de intentar acceder a su valor
                    if (diffusionReferrerDiscountInput) diffusionReferrerDiscountInput.value = ''; 
                    if (diffusionNewClientDiscountInput) diffusionNewClientDiscountInput.value = ''; 
                    // Ya no se necesita limpiar discountPercentageInput porque no existe
                    // if (discountPercentageInput) discountPercentageInput.value = '';
                    treatmentTypeInput.value = '';
                } else {
                    reminderFields.style.display = 'none';
                    promotionFields.style.display = 'block';
                    // Limpiar campos de recordatorio al cambiar
                    clientNameInput.value = '';
                    appointmentDateInput.value = '';
                    referrerDiscountInput.value = ''; 
                    newClientDiscountInput.value = ''; 
                }
                generatedLinkDiv.innerHTML = 'Aquí aparecerá el enlace generado'; 
                copyLinkBtn.style.display = 'none';
            }

            linkTypeRadios.forEach(radio => {
                radio.addEventListener('change', (event) => {
                    toggleLinkType(event.target.value);
                });
            });

            generateLinkBtn.addEventListener('click', () => {
                const selectedType = document.querySelector('input[name="linkType"]:checked').value;
                const params = [];

                if (selectedType === 'reminder') {
                    const clientName = clientNameInput.value.trim();
                    const appointmentDate = appointmentDateInput.value.trim();
                    const referrerDiscount = referrerDiscountInput.value.trim(); 
                    const newClientDiscount = newClientDiscountInput.value.trim(); 

                    if (clientName) {
                        params.push(`nombre=${encodeURIComponent(clientName)}`);
                    }
                    if (appointmentDate) {
                        params.push(`fecha=${encodeURIComponent(appointmentDate)}`);
                    } else {
                        alert('Para un Recordatorio de Turno, la fecha y hora del turno son obligatorias.');
                        return;
                    }
                    if (referrerDiscount) { 
                        params.push(`descuentoReferente=${encodeURIComponent(referrerDiscount)}`);
                    }
                    if (newClientDiscount) { 
                        params.push(`descuentoNuevoCliente=${encodeURIComponent(newClientDiscount)}`);
                    }
                    // Si se desea pasar un descuento general o tratamiento en el modo recordatorio,
                    // se debería añadir un campo en la sección de recordatorio para ello.
                    // Actualmente, discountPercentageInput y treatmentTypeInput solo se usan en promotionFields.
                    // const discount = discountPercentageInput.value.trim();
                    // const treatment = treatmentTypeInput.value.trim();
                    // if (discount) {
                    //     params.push(`descuento=${encodeURIComponent(discount)}`);
                    // }
                    // if (treatment) {
                    //     params.push(`tratamiento=${encodeURIComponent(treatment)}`);
                    // }

                } else { // promotion
                    const promoClientName = promoClientNameInput.value.trim();
                    const diffusionReferrerDiscount = diffusionReferrerDiscountInput.value.trim(); 
                    const diffusionNewClientDiscount = diffusionNewClientDiscountInput.value.trim(); 
                    // discountPercentageInput ya no existe, se usa diffusionReferrerDiscount y diffusionNewClientDiscount
                    // const discount = discountPercentageInput.value.trim(); 
                    const treatment = treatmentTypeInput.value.trim();

                    if (promoClientName) {
                        params.push(`nombre=${encodeURIComponent(promoClientName)}`);
                    }
                    if (diffusionReferrerDiscount) { 
                        params.push(`descuentoReferenteDifusion=${encodeURIComponent(diffusionReferrerDiscount)}`);
                    }
                    if (diffusionNewClientDiscount) { 
                        params.push(`descuentoNuevoClienteDifusion=${encodeURIComponent(diffusionNewClientDiscount)}`);
                    }
                    // Si se desea un descuento general para la promoción (no de referido), se debería añadir un campo específico.
                    // if (discount) {
                    //     params.push(`descuento=${encodeURIComponent(discount)}`);
                    // }
                    if (treatment) {
                        params.push(`tratamiento=${encodeURIComponent(treatment)}`);
                    }
                    
                    // Asegurar que al menos uno de los campos de promo esté lleno
                    if (!promoClientName && !diffusionReferrerDiscount && !diffusionNewClientDiscount && !treatment) {
                        alert('Para un enlace de difusión, ingresa al menos el nombre del cliente o una promoción (descuento/tratamiento).');
                        return;
                    }
                }

                let generatedUrl = baseUrl;
                if (params.length > 0) {
                    generatedUrl += `?${params.join('&')}`;
                }

                // Limpiar contenido previo y crear el enlace clicable
                generatedLinkDiv.innerHTML = ''; 
                const linkElement = document.createElement('a');
                linkElement.href = generatedUrl;
                linkElement.textContent = generatedUrl;
                linkElement.target = '_blank'; // Abrir en una nueva pestaña

                generatedLinkDiv.appendChild(linkElement); // Agregar el enlace al div
                copyLinkBtn.style.display = 'inline-block'; // Mostrar botón de copiar
            });

            // Copiar el enlace al portapapeles
            copyLinkBtn.addEventListener('click', () => {
                // Obtener el href del enlace generado para copiar la URL completa y correcta
                const linkToCopy = generatedLinkDiv.querySelector('a').href;
                if (linkToCopy) {
                    navigator.clipboard.writeText(linkToCopy).then(() => {
                        copyNotification.classList.add('show');
                        setTimeout(() => {
                            copyNotification.classList.remove('show');
                        }, 2000);
                    }).catch(err => {
                        console.error('Error al copiar el texto: ', err);
                        alert('Hubo un error al copiar el enlace. Inténtalo manualmente.');
                    });
                }
            });

            // Asegurarse de que al cargar la página se muestren los campos correctos (recordatorio por defecto)
            toggleLinkType('reminder');
        });
    </script>
  </body>
</html>
